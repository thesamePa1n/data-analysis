import numpy as np

x1 = np.array([
    161,131,261,139,291,117,93,99,201,115,121,296,231,197,151,331,239,199,
    301,131,461,496,199,111,170,371,275,140,133,119,177,219,207,125,189,297
])
x2 = np.array([
    91,91,81,161,131,111,151,261,161,111,171,51,111,161,191,161,131,151,
    111,131,111,161,161,231,261,131,131,161,151,231,261,191,131,191,171,28
])
x3 = np.array([
    63,33,65,41,93,29,35,20,28,21,22,39,33,29,25,43,34,30,40,23,56,59,30,
    21,27,47,37,24,22,22,27,32,30,22,29,39
])
x4 = np.array([
    19,23,17,20,15,19,23,27,22,19,15,28,33,20,18,27,21,21,27,17,33,35,21,
    19,16,29,24,17,19,19,16,22,25,16,26,23
])

X = np.column_stack([x1, x2, x3, x4])

means = X.mean(axis=0)
sigmas = X.std(axis=0)

Z = (X - means) / sigmas

Z_T = Z.T

n = X.shape[0]
R = (1/n) * Z_T @ Z

eigenvalues, eigenvectors = np.linalg.eig(R)
V = eigenvectors

Lambda_sqrt = np.diag(np.sqrt(eigenvalues))
A = V @ Lambda_sqrt
A_inv = np.linalg.inv(A)

F = A_inv @ Z_T

print(F)
print()
print(F.T)